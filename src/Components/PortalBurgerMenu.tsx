import { Dispatch, SetStateAction, useEffect } from 'react';
import { createPortal } from 'react-dom';
import { Link } from 'react-router-dom';

type PortalMenu = {
	isOpen: boolean;
	setIsOpen: Dispatch<SetStateAction<boolean>>;
};

export default function PortalBurgerMenu({ isOpen, setIsOpen }: PortalMenu) {
	useEffect(() => {
		document.addEventListener('click', closePopup);
		return () => {
			document.removeEventListener('click', closePopup);
		};
	});

	function closePopup(e: MouseEvent) {
		const target = e.target as HTMLButtonElement;

		if (target.matches('#portalMenu')) {
			setIsOpen(false);
		}
	}

	function isPageCurrent(url: string) {
		const currentPage = window.location.pathname === url;

		if (currentPage) setIsOpen(false);
	}

	return createPortal(
		<div
			id="portalMenu"
			className={`${
				isOpen ? 'z-[500] translate-x-0' : 'z-[-1] -translate-x-[1000rem]'
			} overflow-y-hidden md:hidden fixed top-0 w-full max-h-[100vh] duration-[300ms] delay-[300ms] text-[#242E49]`}>
			<div className="p-[16rem] flex flex-col w-[100vw] h-[100dvh] bg-[#EDF0F4] ">
				<div className="flex h-[46rem] mb-[72rem] flex-row items-center justify-between">
					<div
						onClick={() => setIsOpen((prev) => !prev)}
						className="mr-[16rem] md:mr-[0rem] hamburger md:hidden">
						<div
							className="burger burger1"
							style={{ transform: `${isOpen ? 'rotate(45deg)' : 'rotate(0)'}` }}
						/>
						<div
							className="burger burger2"
							style={{
								transform: `${isOpen ? 'translateY(100%)' : 'translateY(0)'}`,
								opacity: `${isOpen ? 0 : 1}`,
							}}
						/>
						<div
							className="burger burger3"
							style={{
								transform: `${isOpen ? 'rotate(-45deg)' : 'rotate(0)'}`,
							}}
						/>
					</div>
					<Link
						onClick={() => isPageCurrent('/')}
						to="/"
						className="duration-200 text-[19rem] font-semibold leading-[140%]">
						<div className="flex justify-center items-center w-[105rem] h-[52rem]">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 51" fill="none">
								<path
									d="M16.0583 20.8796C18.1797 22.2301 19.2404 24.1709 19.2404 26.6968C19.2404 28.9327 18.4411 30.7484 16.8374 32.144C15.2338 33.5445 13.2482 34.2448 10.8804 34.2448H0.00195312V8.46973H10.1415C12.4589 8.46973 14.4044 9.14999 15.9678 10.5155C17.5362 11.8761 18.3154 13.6517 18.3154 15.8376C18.3154 17.8984 17.5613 19.5791 16.0583 20.8796ZM10.1364 13.9969H5.91875V18.5637H10.1364C10.8 18.5637 11.3429 18.3486 11.7652 17.9184C12.1874 17.4882 12.3936 16.943 12.3936 16.2778C12.3936 15.6125 12.1824 15.0673 11.7652 14.6421C11.3479 14.212 10.805 13.9969 10.1364 13.9969ZM10.8754 28.7226C11.6144 28.7226 12.2076 28.4975 12.6499 28.0424C13.0923 27.5872 13.3185 26.992 13.3185 26.2567C13.3185 25.5214 13.0973 24.9262 12.6499 24.471C12.2076 24.0158 11.6144 23.7907 10.8754 23.7907H5.91875V28.7226H10.8754Z"
									fill="#3563E9"
								/>
								<path
									d="M23.2186 7.9707H27.1045C27.6675 7.9707 28.1199 8.42588 28.1199 8.9811V33.2306C28.1199 33.7908 27.6625 34.241 27.1045 34.241H23.2186C22.6556 34.241 22.2031 33.7858 22.2031 33.2306V8.9811C22.2031 8.42088 22.6606 7.9707 23.2186 7.9707Z"
									fill="#3563E9"
								/>
								<path
									d="M54.4659 30.8949C51.8518 33.4709 48.6697 34.7614 44.9195 34.7614C41.1694 34.7614 37.9873 33.4709 35.3732 30.8949C32.7592 28.3189 31.4521 25.1376 31.4521 21.3612C31.4521 17.5847 32.7592 14.4035 35.3732 11.8274C37.9873 9.25144 41.1694 7.96094 44.9195 7.96094C48.6697 7.96094 51.8518 9.25144 54.4659 11.8274C57.0799 14.4035 58.3869 17.5847 58.3869 21.3612C58.3869 25.1376 57.0799 28.3189 54.4659 30.8949ZM39.5356 26.8833C40.9784 28.3089 42.773 29.0192 44.9195 29.0192C47.0661 29.0192 48.8607 28.3089 50.3035 26.8833C51.7462 25.4628 52.4701 23.6171 52.4701 21.3612C52.4701 19.1053 51.7462 17.2596 50.3035 15.839C48.8607 14.4135 47.0661 13.7032 44.9195 13.7032C42.773 13.7032 40.9784 14.4135 39.5356 15.839C38.0928 17.2646 37.369 19.1053 37.369 21.3612C37.369 23.6171 38.0928 25.4628 39.5356 26.8833Z"
									fill="#3563E9"
								/>
								<path
									d="M70.4093 34.7579C67.5992 34.7579 65.2616 33.8275 63.3966 31.9618C61.5366 30.0961 60.6016 27.7902 60.6016 25.0391C60.6016 22.288 61.5316 19.9821 63.3966 18.1164C65.2566 16.2507 67.5992 15.3203 70.4093 15.3203C72.1838 15.3203 73.8176 15.7505 75.3106 16.6108C76.8037 17.4712 77.9548 18.6116 78.7692 20.0372L73.9232 22.8332C73.2546 21.4577 72.0581 20.7724 70.3339 20.7724C69.1274 20.7724 68.127 21.1726 67.3378 21.9679C66.5485 22.7632 66.1514 23.7886 66.1514 25.0441C66.1514 26.2996 66.5435 27.32 67.3378 28.1203C68.127 28.9156 69.1274 29.3158 70.3339 29.3158C72.0833 29.3158 73.2797 28.6305 73.9232 27.255L78.7692 30.0161C77.9548 31.4666 76.8087 32.6171 75.3257 33.4774C73.8478 34.3377 72.2039 34.7679 70.4043 34.7679L70.4093 34.7579Z"
									fill="#3563E9"
								/>
								<path
									d="M91.8392 15.3185C93.8098 15.3185 95.4587 15.9938 96.7808 17.3443C98.0979 18.6948 98.7614 20.5605 98.7614 22.9415V34.2459H93.2116V23.7518C93.2116 22.6714 92.91 21.846 92.3068 21.2658C91.7035 20.6906 90.9293 20.4005 89.9943 20.4005C88.9336 20.4005 88.0941 20.7206 87.4758 21.3559C86.8575 21.9961 86.5508 22.9365 86.5508 24.192V34.2409H81.001V8.46582H86.5508V17.5594C87.6618 16.0638 89.4263 15.3135 91.8443 15.3135L91.8392 15.3185Z"
									fill="#3563E9"
								/>
								<path
									d="M107.526 27.248C108.165 28.9687 109.648 29.824 111.965 29.824C113.468 29.824 114.655 29.3588 115.519 28.4235L119.958 30.9645C118.133 33.4905 115.444 34.7559 111.89 34.7559C108.783 34.7559 106.295 33.8356 104.435 31.9949C102.575 30.1542 101.64 27.8332 101.64 25.0372C101.64 22.2411 102.56 19.9502 104.394 18.0994C106.234 16.2487 108.592 15.3184 111.483 15.3184C114.172 15.3184 116.409 16.2437 118.199 18.0994C119.988 19.9552 120.883 22.2661 120.883 25.0372C120.883 25.8225 120.808 26.5577 120.662 27.248H107.526ZM107.416 23.1264H115.373C114.831 21.1856 113.524 20.2203 111.452 20.2203C109.381 20.2203 107.964 21.1906 107.421 23.1264H107.416Z"
									fill="#3563E9"
								/>
								<path
									d="M141.79 34.2448H135.501L129.579 26.1216V34.2448H124.029V8.46973H129.579V23.8957L135.129 15.8326H141.604L134.868 25.0362L141.785 34.2398L141.79 34.2448Z"
									fill="#3563E9"
								/>
								<path
									d="M5.5791 44.7178V49.9998H4.70942V46.2384L3.09575 48.8944H2.99018L1.37651 46.2334V50.0048H0.506836V44.7228H1.44689L3.04548 47.3638L4.6491 44.7228H5.58413L5.5791 44.7178Z"
									fill="#3563E9"
								/>
								<path
									d="M11.3024 49.1695H13.6501V49.9998H10.4277V44.7178H13.6098V45.5481H11.2974V46.9186H13.4188V47.739H11.2974V49.1645L11.3024 49.1695Z"
									fill="#3563E9"
								/>
								<path
									d="M22.2188 49.1684H22.7869V51.0091H21.9172V49.9987H18.6949V51.0091H17.8252V49.1684H18.3178C18.6245 48.7683 18.7803 48.163 18.7803 47.3527V44.7217H22.2238V49.1734L22.2188 49.1684ZM19.2679 49.1684H21.3441V45.532H19.645V47.3627C19.645 48.148 19.5193 48.7483 19.2679 49.1634V49.1684Z"
									fill="#3563E9"
								/>
								<path
									d="M30.518 49.9998V46.3934L27.9995 49.9998H27.3359V44.7178H28.2056V48.2992L30.7091 44.7178H31.3927V49.9998H30.5231H30.518Z"
									fill="#3563E9"
								/>
								<path
									d="M40.1451 49.1695H40.7132V51.0102H39.8435V49.9998H36.2441V44.7178H37.1138V49.1695H39.2754V44.7178H40.1451V49.1695Z"
									fill="#3563E9"
								/>
								<path
									d="M48.4477 49.9998V46.3934L45.9292 49.9998H45.2656V44.7178H46.1353V48.2992L48.6388 44.7178H49.3224V49.9998H48.4528H48.4477Z"
									fill="#3563E9"
								/>
								<path
									d="M57.3157 44.7178H58.1854V49.9998H57.3157V47.7139H55.0435V49.9998H54.1738V44.7178H55.0435V46.8836H57.3157V44.7178Z"
									fill="#3563E9"
								/>
								<path
									d="M65.5483 50.0915C64.7491 50.0915 64.0855 49.8314 63.5627 49.3012C63.0348 48.776 62.7734 48.1257 62.7734 47.3504C62.7734 46.5751 63.0348 45.9249 63.5627 45.3997C64.0855 44.8745 64.7491 44.6094 65.5483 44.6094C66.0259 44.6094 66.4733 44.7244 66.8805 44.9495C67.2877 45.1746 67.6044 45.4847 67.8306 45.8699L67.0715 46.305C66.9308 46.0449 66.7247 45.8349 66.4532 45.6848C66.1818 45.5297 65.8801 45.4547 65.5483 45.4547C64.9803 45.4547 64.5228 45.6348 64.1709 45.9899C63.8191 46.3451 63.6431 46.8002 63.6431 47.3454C63.6431 47.8907 63.8191 48.3458 64.1709 48.701C64.5228 49.0561 64.9803 49.2362 65.5483 49.2362C65.8801 49.2362 66.1868 49.1612 66.4582 49.0061C66.7297 48.851 66.9358 48.646 67.0715 48.3859L67.8306 48.816C67.6094 49.2012 67.2927 49.5113 66.8855 49.7414C66.4783 49.9715 66.0309 50.0865 65.5483 50.0865V50.0915Z"
									fill="#3563E9"
								/>
								<path
									d="M76.3394 49.9998H75.2988L73.2076 47.4839V49.9998H72.3379V44.7178H73.2076V47.0887L75.2234 44.7178H76.264L74.1175 47.2888L76.3394 49.9948V49.9998Z"
									fill="#3563E9"
								/>
								<path
									d="M83.8803 49.9998V46.3934L81.3618 49.9998H80.6982V44.7178H81.5679V48.2992L84.0714 44.7178H84.7551V49.9998H83.8854H83.8803Z"
									fill="#3563E9"
								/>
								<path
									d="M92.7886 49.998V46.3916L90.27 49.998H89.6064V44.716H90.4761V48.2973L92.9796 44.716H93.6633V49.998H92.7936H92.7886ZM90.5767 44.1907V43.4805H92.6981V44.1907H90.5767Z"
									fill="#3563E9"
								/>
								<path
									d="M108.096 49.1695H108.664V51.0102H107.795V49.9998H104.195V44.7178H105.065V49.1695H107.227V44.7178H108.096V49.1695Z"
									fill="#3563E9"
								/>
								<path
									d="M114.088 49.1695H116.435V49.9998H113.213V44.7178H116.395V45.5481H114.083V46.9186H116.204V47.739H114.083V49.1645L114.088 49.1695Z"
									fill="#3563E9"
								/>
								<path
									d="M124.167 44.7178H125.037V49.9998H124.167V47.7139H121.895V49.9998H121.025V44.7178H121.895V46.8836H124.167V44.7178Z"
									fill="#3563E9"
								/>
								<path
									d="M133.344 44.7178V45.5481H131.851V49.9998H130.982V45.5481H129.479V44.7178H133.344Z"
									fill="#3563E9"
								/>
								<path
									d="M139.729 44.7178C140.232 44.7178 140.649 44.8828 140.986 45.218C141.323 45.5481 141.488 45.9633 141.488 46.4535C141.488 46.9436 141.317 47.3538 140.986 47.6889C140.654 48.0241 140.232 48.1891 139.729 48.1891H138.643V49.9998H137.773V44.7178H139.729ZM139.729 47.3738C139.985 47.3738 140.196 47.2888 140.367 47.1137C140.533 46.9386 140.619 46.7186 140.619 46.4535C140.619 46.1883 140.533 45.9683 140.367 45.7932C140.201 45.6181 139.99 45.5331 139.729 45.5331H138.643V47.3738H139.729Z"
									fill="#3563E9"
								/>
								<path
									d="M160 5.89328V11.0503H154.078V16.9426H148.9V11.0503H142.979V5.89328H148.9V0.000976562H154.078V5.89328H160Z"
									fill="#3563E9"
								/>
							</svg>
						</div>
					</Link>
				</div>
				<div className="flex flex-col items-center gap-[24rem] text-[20rem] font-medium leading-[140%] duration-200 pb-[49rem]">
					<Link
						onClick={() => isPageCurrent('/services')}
						to="/services"
						className="hover:text-[#3563E9] duration-200">
						Услуги и цены
					</Link>
					<div className="w-[245rem] h-[1rem] bg-[#F6F7F9]"></div>
					<Link
						onClick={() => isPageCurrent('/doctors')}
						to="/doctors"
						className="hover:text-[#3563E9] duration-200">
						Врачи
					</Link>
					<div className="w-[245rem] h-[1rem] bg-[#F6F7F9]"></div>
					<Link
						onClick={() => isPageCurrent('/clinic')}
						to="/clinic"
						className="hover:text-[#3563E9] duration-200">
						Клиника
					</Link>
					<div className="w-[245rem] h-[1rem] bg-[#F6F7F9]"></div>
					<Link
						onClick={() => isPageCurrent('/contacts')}
						to="/contacts"
						className="hover:text-[#3563E9] duration-200">
						Контакты
					</Link>
				</div>
				<div className="flex items-end justify-center pb-[70rem] grow-[3] w-full text-center text-[20rem] font-medium leading-[140%]">
					+8 (903) 799-30-30
				</div>
			</div>
		</div>,
		document.getElementById('root')!,
	);
}
